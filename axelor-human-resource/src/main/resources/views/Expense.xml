<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_3.0.xsd">

	<grid name="expense-grid" title="Expenses" model="com.axelor.apps.hr.db.Expense">
		<field name="sentDate"/>
		<field name="period"/>
		<field name="user"/>
		<field name="statusSelect"/>
	</grid>

	<form name="expense-form" title="Expense" model="com.axelor.apps.hr.db.Expense"
	    onNew="action-expense-record-default" width="large">
		<panel>
		    <field name="statusSelect" colSpan="12" widget="NavSelect"/>
			<field name="sentDate" colSpan="3"/>
			<field name="period" colSpan="3"/>
			<field name="user" colSpan="3"/>
			<button name="sendExpenses" title="Send Expenses" onClick="action-expense-record-status-confirmed, save, action-expense-view-new-expense" colSpan="3" readonlyIf="statusSelect &gt; 1"/>
		</panel>
		<panel-related field="expenseLineList" readonlyIf="statusSelect &gt; 1"/>
	</form>
	
	<action-record name="action-expense-record-default" model="com.axelor.apps.hr.db.Expense">
	    <field name="user" expr="eval:__user__"/>
	    <field name="period" expr="eval: __repo__.of(Period).all().filter('self.fromDate &lt;= ?1 AND self.toDate &gt;= ?1',__date__).fetchOne()"/>
	</action-record>
	
	<action-record name="action-expense-record-status-confirmed" model="com.axelor.apps.hr.db.Expense">
	    <field name="statusSelect" expr="2"/>
	</action-record>
	
	<action-view name="action-expense-view-new-expense" title="Expense" model="com.axelor.apps.hr.db.Expense">
		<view type="form" name="expense-form"/>
		<view type="grid" name="expense-grid"/>
	</action-view>

</object-views>
