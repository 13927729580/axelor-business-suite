<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_4.1.xsd">
	
  
  	<grid name="ebics-partner-grid" title="Ebics partner" model="com.axelor.apps.bankpayment.db.EbicsPartner" >
		<field name="partnerId" />
		<field name="ebicsBank"/>
	</grid>
	
	<form name="ebics-partner-form" title="Ebics partner" model="com.axelor.apps.bankpayment.db.EbicsPartner">
	
		<panel title="General informations">
			<field name="partnerId" help="Name of the contract/subscription" max="35" x-bind="{{partnerId|uppercase}}" pattern='^[A-Z0-9]+$'/>
			<field name="ebicsBank" />
			<field name="testMode"/>
		</panel>
		
		<panel title="Bank statements" colSpan="12">
			<field name="bankStatementFileFormatSet" widget="TagSelect" canNew="false" canEdit="false" colSpan="6" form-view="bank-statement-file-format-form" grid-view="bank-statement-file-format-grid"/>
			<field name="bankStatementEbicsUser" colSpan="6" domain="self.ebicsPartner.id = :id" form-view="ebics-user-form" grid-view="ebics-user-grid"/>
			<field name="bankStatementGetModeSelect" colSpan="6" widget="radio-select" x-direction="horizontal"/>
			<field name="bankStatementLastExeDateT" readonly="true" colSpan="6"/>
			<field name="bankStatementStartDate" colSpan="6" showIf="bankStatementGetModeSelect == 2"/>
			<field name="bankStatementEndDate" colSpan="6" showIf="bankStatementGetModeSelect == 2"/>
			<button name="getBankStatementButton" title="Get the bank statements" colSpan="6" onClick="save,action-ebics-partner-method-get-bank-statement" readonlyIf="!bankStatementFileFormatSet"/>
		</panel>
		
		<panel title="Payment Status Report">
			<field name="usePSR" widget="boolean-switch"/>
			<field name="pSRBankStatementFileFormat" showIf="usePSR"/>
		</panel>
		
		<panel-related field="bankDetailsSet" colSpan="12" canNew="true" showIf="ebicsBank" hidden="true" form-view="bank-details-form" grid-view="bank-details-grid" onSelect="action-ebics-partner-method-bank-details-set-domain"/>
	
	</form>
	
	
	<action-method name="action-ebics-partner-method-get-bank-statement">
		<call class="com.axelor.apps.bankpayment.ebics.web.EbicsPartnerController" method="getBankStatement"/>
	</action-method>
	
	<action-attrs name="action-ebics-partner-method-bank-details-set-domain">
		<attribute name="domain" for="bankDetailsSet" expr="eval: &quot; self.bank.id = ${ebicsBank?.bank?.id}"/>
	</action-attrs>
	
</object-views>
