<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_2.0.xsd">

    <grid name="accounting-batch-grid" title="Accounting batches" model="com.axelor.apps.account.db.AccountingBatch">
    	<field name="actionSelect" />
    	<field name="code" />
		<field name="company" />
		<field name="createdOn"/>
		<field name="createdBy"/>
    </grid>
 
    <form name="accounting-batch-form" title="Accounting Batch" model="com.axelor.apps.account.db.AccountingBatch" cols="4"
    onNew="action-accounting-batch-record-on-new">
    	<field name="actionSelect" onChange="action-accounting-batch-record-default-currency"/>
    	<field name="code" />
    	<field name="company" widget="SuggestBox"/>
    	<field name="bankDetails" widget="SuggestBox" hideIf="actionSelect &amp;&amp; ([14,15,16,17,18].indexOf(actionSelect) > -1 || (actionSelect == 11 &amp;&amp; reimbursementTypeSelect == 2) || (actionSelect == 12 &amp;&amp; directDebitTypeSelect == 2))" onSelect="action-accounting-batch-attrs-bank-details-domain"/>
    	<field name="archived" title="Archived ?" />
    	<break/>
    	<notebook colSpan="4">
    		<page name="reimbursementPage" title="Reimbursement configuration" cols="4" hideIf="actionSelect != 11">
    			<field name="reimbursementTypeSelect"/>
    			<field name="reimbursementExportTypeSelect" hideIf="reimbursementTypeSelect != 1"/>
    			<field name="currency" readonly="true"/>
    		</page>
    		<page name="directDebitPage" title="Direct debit configuration" cols="4"  hideIf="actionSelect != 12">
    			<field name="directDebitTypeSelect"/>
    			<field name="currency" readonly="true"/>
    			<group name="directDebitExportGroup" colSpan="4" hideIf="directDebitTypeSelect != 1">
	    			<field name="directDebitExportTypeSelect"/>
	    			<field name="debitDate"/>
	    			<field name="hasToReExportCfbonb" showIf="directDebitExportTypeSelect != 2"/>
	    			<field name="batchToReExport" showIf="hasToReExportCfbonb" domain="self.accountingBatch.id = :id"/>
    			</group>
    			<field name="isSepaDirectDebit"/>
    		</page>
    		<page name="reminderPage" title="Reminder configuration" cols="4" hideIf="actionSelect != 14">
    			<field name="reminderTypeSelect"/>
    		</page>
    		<page name="interbankPaymentOrderPage" title="Payments by IPO and IPO Cheque configuration" cols="4"  hideIf="actionSelect != 15">
    			<field name="interbankPaymentOrderTypeSelect"/>
    			<field name="currency" readonly="true"/>
    		</page>
    		<page name="doubtfulCustormerPage" title="Doubtful customers configuration" cols="4" hideIf="actionSelect != 16">
    		</page>
    		<page name="accountCustomerPage" title="Account calculation configuration" cols="4" hideIf="actionSelect != 17">
    			<group title="Update" colSpan="4" cols="6">
	    			<field name="updateCustAccountOk"/>
	    			<field name="updateDueCustAccountOk"/>
	    			<field name="updateDueReminderCustAccountOk"/>
    			</group>
    		</page>
    		<page name="moveLineExportPage" title="Move Lines Export Config" hideIf="actionSelect != 18">
    			<field name="moveLineExportTypeSelect"/>
    			<field name="startDate"/>
   				<field name="endDate"/>
    		</page>
    		
    		<page title="Information" cols="4">
    			<field name="createdOn" title="Created on"/>
				<field name="createdBy" title="Created by" />
		    	<field name="description" showTitle="false" colSpan="4" />
		    	<field name="batchList" colSpan="4" />
    		</page>
    	</notebook> 
    	<button name="reimbursementBatch" title="Reimbursement Batch" colSpan="4" onClick="save,action-accounting-batch-method-action-reimbursement"  hideIf="actionSelect != 11" />
    	<button name="directDebitBatch" title="Direct Debit Batch" colSpan="4" onClick="save,action-accounting-batch-method-action-direct-debit"  hideIf="actionSelect != 12" />
    	<button name="reminderBatch" title="Reminder Batch" colSpan="4" onClick="save,action-accounting-batch-method-action-reminder"  hideIf="actionSelect != 14" />  	
    	<button name="interbankPaymentOrderBatch" title="Interbank Payment Order Batch" colSpan="4" onClick="save,action-accounting-batch-method-action-interbank-payment-order"  hideIf="actionSelect != 15" />
    	<button name="doubtfulCustomerBatch" title="Doubtful Customer Batch" colSpan="4" onClick="save,action-accounting-batch-method-action-doubtful-customer"  hideIf="actionSelect != 16" />
    	<button name="accountCustomerBatch" title="Start" colSpan="3" onClick="save,action-accounting-batch-method-action-account-customer" hideIf="actionSelect != 17" />
    	<button name="moveLineExportBatch" title="Start" colSpan="3" onClick="save,action-accounting-batch-method-action-move-line-export" hideIf="actionSelect != 18" />
    </form>
    
    <!-- ACTION RECORD -->
    <action-record name="action-accounting-batch-record-on-new" model="com.axelor.apps.account.db.AccountingBatch">
		<field name="createdOn" expr="call:com.axelor.apps.base.service.administration.GeneralService:getTodayDate()"/>
		<field name="createdBy" expr="eval:__user__"/>
	</action-record>
    
    <action-record name="action-accounting-batch-record-default-currency" model="com.axelor.apps.account.db.AccountingBatch">
    	<field name="currency" expr="eval: com.axelor.apps.base.db.Currency.findByCode(&quot;EUR&quot;)" if="actionSelect == 11 || actionSelect == 12 || actionSelect == 15 "/>
    
    </action-record>
    
    <!-- ACTION METHOD -->
	<action-method name="action-accounting-batch-method-action-reimbursement">
		<call class="com.axelor.apps.account.web.AccountingBatchController" method="actionReimbursement"/>
	</action-method>
	
	<action-method name="action-accounting-batch-method-action-direct-debit">
		<call class="com.axelor.apps.account.web.AccountingBatchController" method="actionDirectDebit"/>
	</action-method>
	
	<action-method name="action-accounting-batch-method-action-reminder">
		<call class="com.axelor.apps.account.web.AccountingBatchController" method="actionReminder"/>
	</action-method>
	
	<action-method name="action-accounting-batch-method-action-interbank-payment-order">
		<call class="com.axelor.apps.account.web.AccountingBatchController" method="actionInterbankPaymentOrder"/>
	</action-method>
	
	<action-method name="action-accounting-batch-method-action-doubtful-customer">
		<call class="com.axelor.apps.account.web.AccountingBatchController" method="actionDoubtfulCustomer"/>
	</action-method>
	
	<action-method name="action-accounting-batch-method-action-account-customer">
		<call class="com.axelor.apps.account.web.AccountingBatchController" method="actionAccountingCustomer"/>
	</action-method>
	
	<action-method name="action-accounting-batch-method-action-move-line-export">
		<call class="com.axelor.apps.account.web.AccountingBatchController" method="actionMoveLineExport"/>
	</action-method>
	
    <!-- ACTION ATTRS -->
	
	<action-attrs name="action-accounting-batch-attrs-bank-details-domain">
        <attribute name="domain" expr="eval: &quot;self.id IN (${company?.bankDetailsSet?.collect{it.id}.join(',')},null)&quot;" for="bankDetails"/>
    </action-attrs>
	
</object-views>