<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_2.0.xsd">

    <grid name="scheduler-instance-grid" title="Schedulers" model="com.axelor.apps.base.db.SchedulerInstance">
        <field name="name"/>
        <field name="lastTheoreticalExecutionDate"/>
        <field name="lastExecutionDate"/>
	    <field name="firstExecutionDate"/>
    </grid>
	
	<form name="scheduler-instance-form" title="Scheduler" model="com.axelor.apps.base.db.SchedulerInstance" cols="6"
		onNew="action-scheduler-instance-record-first-execution-date"
		onSave="scheduler-instance-validate-infos">
	    <field name="name" colSpan="2"/>
	    <break/>
	    <field name="scheduler" colSpan="4"/>
	    <break/>
	    <group showTitle="false" colSpan="6" cols="6">
	    	<field name="firstExecutionDate" required="true" readonlyIf="lastExecutionDate"/>
		    <field name="lastTheoreticalExecutionDate" readonly="true"/>
		    <field name="lastExecutionDate" readonly="true"/>
	    </group>
	    <field name="schedulerInstanceHistoryList" colSpan="6"/>
	</form>
	
	<action-validate name="scheduler-instance-validate-infos">
		<error message="Please, enter date of next execution." if="!firstExecutionDate"/>
	</action-validate>
	
	<action-record name="action-scheduler-instance-record-first-execution-date" model="com.axelor.apps.base.db.SchedulerInstance">
		<field name="firstExecutionDate" expr="eval: _parent?.invoicedFirstDate" if="_parent._model == 'com.axelor.apps.sale.db.SaleOrder"/>
	</action-record>
	
</object-views>
