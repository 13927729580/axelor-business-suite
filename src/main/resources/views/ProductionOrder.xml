<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_2.0.xsd">
    
    <grid name="production-order-grid" title="Production orders" model="com.axelor.apps.production.db.ProductionOrder" orderBy="-productionOrderSeq">
        <field name="productionOrderSeq"/>
        <!--  TODO: this field is commented in domain
        <field name="businessProject"/>
         -->
    </grid>
    
    <form name="production-order-form" title="Production order" model="com.axelor.apps.production.db.ProductionOrder" cols="4">
        <field name="productionOrderSeq"/>
        <!--  TODO: this field is commented in domain
        <field name="businessProject"/>
        -->
        <field name="isToInvoice" onChange="save,action-production-order-method-is-to-invoice"/>
        <button name="showManufOrderWizard" title="Add Manuf. Order" colSpan="2" onClick="action-production-order-attrs-add-manuf-order-wizard,action-production-order-record-default-wizard"/>
        <group name="addManufOrderWizard" title="Add Manu. Order" hidden="true" colSpan="2">
	        <field name="product" widget="ManyToOne" x-target="com.axelor.apps.base.db.Product" title="Product"/>
	        <field name="billOfMaterial" widget="ManyToOne" x-target="com.axelor.apps.production.db.BillOfMaterial" title="BOM" 
			onSelect="action-production-order-wizard-attrs-bill-of-material-domain"
			onChange="action-production-order-wizard-record-product"/>
			<field name="qty" widget="decimal" title="Quantity"/>
	        <button name="AddManufOrder" title="Add Manuf. Order" colSpan="2" onClick="action-production-order-method-add-manuf-order"/>
        </group>
<!--         <button name="generateSaleOrder" title="Generate sale order" colSpan="2" onClick="action-production-order-method-generate-sale-order" showIf="businessProject"/> -->
        <field name="manufOrderList" colSpan="4"/>
        <portlet colSpan="4" action="action-production-order-view-operation-order"/>
    </form>
    
    
    <action-method name="action-production-order-method-is-to-invoice">
    	<call class="com.axelor.apps.production.web.ProductionOrderController" method="propagateIsToInvoice"/>
    </action-method>
    
    <action-method name="action-production-order-method-generate-sale-order">
    	<call class="com.axelor.apps.production.web.ProductionOrderController" method="generateSaleOrder"/>
    </action-method>
    
   	<action-method name="action-production-order-method-add-manuf-order">
    	<call class="com.axelor.apps.production.web.ProductionOrderController" method="addManufOrder"/>
    </action-method>
    
    <action-record name="action-production-order-record-default-wizard" model="com.axelor.apps.base.db.Wizard">
		<field name="qty" expr="eval: 1.0"/>
	</action-record>
    
    <action-attrs name="action-production-order-attrs-add-manuf-order-wizard">
    	<attribute name="hidden" for="addManufOrderWizard" expr="eval: false"/>
    	<attribute name="hidden" for="showManufOrderWizard" expr="eval: true"/>
    </action-attrs>
    
    <action-view name="action-production-order-view-operation-order" title="Operation orders" model="com.axelor.apps.production.db.OperationOrder">
  		<view type="grid" name="operation-order-group-grid"/>
		<view type="form" name="operation-order-form"/>
  		<domain>self.manufOrder.productionOrder.id = :id</domain>
  		<context name="id" expr="eval: id"/>
  	</action-view>
    
    <search-filters name="production-order-filters" model="com.axelor.apps.production.db.ProductionOrder" title="Production order filters">
		<filter title="Production orders to invoice">
			<domain>self.isToInvoice = true</domain>
		</filter>
		<filter title="Production orders closed">
			<domain>self.isClosed = true</domain>
		</filter>
	</search-filters>
	
	
</object-views>
