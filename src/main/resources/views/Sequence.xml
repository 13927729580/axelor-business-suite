<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_0.9.xsd">
    
  
    <grid name="sequence-grid" title="Les séquences" model="com.axelor.apps.base.db.Sequence">
    	<toolbar>
    		<button name="reset" title="Réinitialiser" onClick="action-sequence-method-reset-all"/>
    	</toolbar>
        <field name="name"/>
        <field name="code" />
        <field name="company"/>
        <field name="prefixe"/>
        <field name="suffixe"/>
        <field name="padding"/>
        <field name="toBeAdded"/>
        <field name="nextNum"/>
    </grid>
    
    <form name="sequence-form" title="Séquence" model="com.axelor.apps.base.db.Sequence" cols="4" 
    	onNew="action-sequence-default,action-sequence-generic-attrs-tool-bar,action-sequence-attrs"
    	onLoad="action-sequence-attrs-tool-bar,action-sequence-attrs">
    	<toolbar>
    		<button name="reset" title="Réinitialiser" onClick="save,action-sequence-method-reset,save"/>
    	</toolbar>
        <field name="name"/>
        <field name="code" onChange="action-sequence-attrs"/>
        <field name="company" widget="SuggestBox"/>
        <field name="journal"/>
        <field name="yearlyResetOk" onChange="action-sequence-attrs-tool-bar"/>
        <field name="prefixe"/>
        <field name="suffixe"/>
        <field name="padding"/>
        <field name="toBeAdded"/>
        <field name="nextNum"/>
        <label title="Légende :" colSpan="4"/>
        <label title="Vous pouvez utiliser les combinaisons ci-dessous dans les champs préfixe et suffixe" colSpan="4"/>
        <label title="%Y : Pour l'année" colSpan="4"/>
        <label title="%M : Pour le mois" colSpan="4"/>
        <label title="%D : Pour le jour" colSpan="4"/>
        <label title="%WY : Pour le numéro de la semaine" colSpan="4"/>
    </form>
    
    <!-- ACTION RECORD -->
    <action-record name="action-sequence-default" model="com.axelor.apps.base.db.Sequence">
    	<field name="padding" expr="3"/>
    	<field name="nextNum" expr="1"/>
    	<field name="toBeAdded" expr="1"/>
    </action-record>
    
    <!-- ACTION METHOD -->
    <action-method name="action-sequence-method-reset-all">
    	<call class="com.axelor.apps.base.web.SequenceController" method="resetAll"/>
    </action-method>
    
    <action-method name="action-sequence-method-reset">
    	<call class="com.axelor.apps.base.web.SequenceController" method="reset"/>
    </action-method>
    
    <!-- ACTION ATTRS -->
    
    <action-attrs name="action-sequence-attrs-tool-bar">
    	<attribute name="hidden" for="reset" expr="eval: !yearlyResetOk"/>
    </action-attrs>
    
    <action-attrs name="action-sequence-attrs">
    	<!-- COMPANY -->
    	<attribute name="hidden" for="company" expr="eval: code in ['contract','contractLine','invoicePaymentCondition','partner']"/>
    	<attribute name="required" for="company" expr="eval: !(code in ['contract','contractLine','invoicePaymentCondition','partner'])"/>
    	<!-- JOURNAL -->
    	<attribute name="hidden" for="journal" expr="eval: !(code in ['move','debit','paymentVoucherReceiptNo','debitReject','paymentVoucher'])"/>
    	<attribute name="required" for="journal" expr="eval: code in ['move','debit','paymentVoucherReceiptNo','debitReject','paymentVoucher']"/>
    </action-attrs>
    
</object-views>
