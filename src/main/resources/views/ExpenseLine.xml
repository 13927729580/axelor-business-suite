<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_0.9.xsd">

	<grid name="expense-edit-line-grid" editable="true" title="Expense Lines"
		model="com.axelor.apps.organisation.db.ExpenseLine">
		<field name="product" />
		<field name="quantity" />
		<field name="unit" />
		<field name="unitPrice" />
		<field name="total" />
	</grid>


	<grid name="expense-line-grid" title="Expense Line"
		model="com.axelor.apps.organisation.db.ExpenseLine">
		<field name="product" />
		<field name="shortDescription" />
		<field name="expenseTypeSelect" />
		<field name="affair" />
		<field name="qty" />
		<field name="unit" />
		<field name="price" />
		<field name="total" />
		<field name="file" />
		<field name="fileReceived" />
		<field name="validationDate" />
	</grid>

	<form name="expense-line-form" title="Expense Line"
		model="com.axelor.apps.organisation.db.ExpenseLine" cols="4" onNew="action-expenseline-default-record">
		<field name="affair" />
		<field name="expenseTypeSelect" />
		<field name="product" onChange="action-expenseline-product"/>
		<field name="unit" />
		<field name="qty" onChange="action-expenseline-compute-total"/>
		<field name="price" onChange="action-expenseline-compute-total"/>
		<field name="reference" />
		<field name="sequence" />
		<field name="total"/>
		<break />
		<group title="Proofs" colSpan="4">
			<field name="file" />
			<field name="fileReceived" />
		</group>
		<field name="validationDate" />
		<field name="isToInvoice"/>
		<field name="isInvoiced"/>
	</form>

	<action-record name="action-expenseline-default-record" model="com.axelor.apps.organisation.db.ExpenseLine">
    	<field name="expenseTypeSelect" expr="notReinvoiceable"/>
    	<field name="qty" expr="1"/>
    </action-record>
    
    <action-record name="action-expenseline-compute-total" model="com.axelor.apps.organisation.db.ExpenseLine">
    	<field name="total" expr="eval:qty*price" if="qty != null &amp;&amp; price != null"/>
    </action-record>
    
    <action-record name="action-expenseline-product" model="com.axelor.apps.organisation.db.ExpenseLine">
    	<field name="shortDescription" expr="product.name"/>
    	<field name="unit" expr="product.unit"/>
    	<field name="price" expr="product.purchasePrice"/>
    	<field name="total" expr="eval:qty*price" if="qty != null &amp;&amp; price != null"/>
    </action-record>
</object-views>