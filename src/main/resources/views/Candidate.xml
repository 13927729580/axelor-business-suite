<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_0.9.xsd">


	<grid name="candidate-grid" title="Candidates" model="com.axelor.apps.organisation.db.Candidate">
		<field name="name" />
		<field name="firstName" />
		<field name="mobilePhone" />
		<field name="email"/>
		<field name="avalabilitySelect" />
		<field name="availabilityDate" />
		<field name="salaryExpectation" />
	</grid>


	<form name="candidate-form" title="Candidate" model="com.axelor.apps.organisation.db.Candidate" 
	 	onSave="action-organisation-candidate-save-record"
		onNew="action-method-candidate-default-record">
		<toolbar>
			<button name="recruit" title="Transform into employee" onClick="" />
		</toolbar>
		<group name="header" cols="6" colSpan="6">
			<field name="name" />
			<field name="firstName" />
			<field name="titleSelect" />
			<group title="Coordonnées" cols="6" colSpan="6">
				<field name="mobilePhone" />
				<field name="fixedPhone" />
				<field name="email" widget="Email"/>
				<field name="address" />
			</group>
			<group title="Recruitment Type" cols="6" colSpan="6">	
				<field name="recruitmentTypeSelect" />
				<field name="macroCategorySelect" />
				<field name="categorySelect" />
			</group>
		</group>
		<notebook>
			<page title="General" cols="6" colSpan="6">
				<field name="relocationSelect" />
				<field name="salaryExpectation" />
				<field name="globalEvaluation" />
				<field name="resume" />
				<field name="coverLetter" />
				<group title="Candidate Follow up" cols="6" colSpan="6">	
					<field name="userInfo"/>
					<field name="createdOn" readonly="true"/>
					<break/>
					<field name="avalabilitySelect" />
					<field name="availabilityDate" />
					<field name="decisionDate" />
					<field name="recruitmentProcessAdvancementList" colSpan="6">
					<form title="Recruitment process progress">
						<field name="stateSelect"/>
						<field name="dateTime"/>
						<field name="comment"/>
					</form>
					<grid title="Recruitment process progresses" editable="true">
						<hilite color="#3333FF" background="#CDEB8B" condition="stateSelect = 0" />
						<field name="stateSelect"/>
						<field name="dateTime"/>
						<field name="comment"/>
					</grid>
				</field>
				</group>
			</page>
			<page title="Profile">
				<group title="-" cols="4" colSpan="6">
					<group title="Keywords" colSpan="2">
						<field name="toolKeywordSet" colSpan="2" grid-view="keyword-grid" widget="TagSelect[create=keyWord]"/>
						<field name="fieldKeywordSet" colSpan="2" grid-view="keyword-grid" widget="TagSelect[create=keyWord]"/>
						<field name="jobKeywordSet" colSpan="2" grid-view="keyword-grid" widget="TagSelect[create=keyWord]"/>
					</group>
					<group title="Companies" colSpan="2">
						<field name="partnerSet" colSpan="4" grid-view="company-grid" domain="self.isContact = 'true'"/>
					</group>
				</group>
				<field name="positionList" colSpan="4"/>	
				<group title="Education/Trainings" cols="4" colSpan="4">	
					<field name="degree"/>
					<!-- TODO set domain domain="self.id IN (1, 2, 3)" -->
					<button name="assign" title="Affect to recruitment pool"
						help="Copy all necessary fields (including Professionnal Background …)"
						colSpan="2" />
					<field name="trainingLineList" colSpan="4"/>
				</group>
			</page>
			<page title="Evaluation">
				<field name="evaluationLineList" colSpan="4"
					form-view="evaluation-line-form" grid-view="evaluation-line-grid"/>
				<field name="evaluationGrade" readonly="true"/>
				<button name="compute" title="Compute" onClick="action-organisation-candidate-evaluation-record"/>
			</page>
			<page title="Additionnal information">
				<field name="personalInfo" widget="NestedEditor" summary-view="true"
					form-view="personal-info-edit-form"/>
			</page>
			<page title="Competences">
				<field name="competence" widget="NestedEditor" summary-view="true"
					form-view="competence-edit-form"/>
			</page>
			<page title="Other opportunities">
				<field name="candidateOtherOpportunityList" grid-view="candidate-other-opportunity-grid" form-view="candidate-other-opportunity-form"/>
			</page>
<!-- 			<page title="Suivi du placement des besoins" hidden="true"> -->
<!-- 				<field name="placementFollowUpList" grid-view="placement-follow-up-edit-grid" form-view="placement-follow-up-edit-list"></field> -->
<!-- 			</page> -->
		</notebook>
	</form>

	<action-record name="action-organisation-candidate-evaluation-record" model="com.axelor.apps.organisation.db.Candidate">
		<field name="evaluationGrade" expr="eval: evaluationLineList?.collect(){ it?.coefficient * it?.gradeSelect }?.sum() / evaluationLineList?.collect(){ it?.coefficient }?.sum()" />
	</action-record>

	<action-record name="action-organisation-candidate-save-record" model="com.axelor.apps.organisation.db.Candidate">
		<field name="toolKeywordSet" expr="eval: toolKeywordSet*.typeSelect = '0';toolKeywordSet" />
		<field name="fieldKeywordSet" expr="eval: fieldKeywordSet*.typeSelect = '1';fieldKeywordSet" />
		<field name="jobKeywordSet"	expr="eval: jobKeywordSet*.typeSelect = '2';jobKeywordSet" />
	</action-record>

	<action-method name="action-method-candidate-default-record">
		<call class="com.axelor.apps.organisation.web.CandidateController" method="onNew" />
	</action-method>


</object-views>