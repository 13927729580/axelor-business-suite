<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_2.1.xsd">
    
    <grid name="reimbursement-grid" title="Reimbursements" model="com.axelor.apps.account.db.Reimbursement">
    	<field name="ref"/>
        <field name="status"/>
        <field name="total"/>
    </grid>
    
    <form cols="4" onLoad="action-account-reimbursement-onload-group" onNew="action-account-reimbursement-onnew-group" name="reimbursement-form" title="Reimbursement" model="com.axelor.apps.account.db.Reimbursement">
	  <panel title="Overview">
	    <field name="ref" x-span="12"/>
	    <field name="partner" domain="self.isContact = false" form-view="partner-form" grid-view="partner-grid"/>
	    <field name="company" widget="SuggestBox" form-view="company-lite-form"/>
	  </panel>
	  <panel title="Reimbursement details">
	    <field name="amountToReimburse"/>
	    <field name="amountReimbursed"/>
	    <field name="bankDetails" form-view="bank-details-form" grid-view="bank-details-grid"/>
	  </panel>
	  <panel title="Reason">
	      <field name="description" x-span="12"/>
	 </panel>
	 <panel  title="Reject Information" >
	     <field name="rejectedOk"/>
	    <field name="interbankCodeLine"/>
	    <field name="rejectDate"/>
	    <field name="rejectMoveLine"/>
	 </panel> 
	<panel-related field="moveLineSet" hideIf="status == null || status.code == 'dra'" x-span="12"/>
	<panel-side title="Info">
	  <field name="status"/>
	  <button name="validateReimbursement" title="Validate" onClick="action-group-account-reimbursement-validate-click"/>
	</panel-side>
</form>
    <action-group name="action-account-reimbursement-onnew-group">
	    <action name="action-reimbursement-hidden-button-attrs"/>
	    <action name="action-reimbursement-hidden-reject-field-attrs"/>
    </action-group>
    
    <action-group name="action-account-reimbursement-onload-group">
	    <action name="action-reimbursement-hidden-button-attrs"/>
	    <action name="action-reimbursement-hidden-reject-field-attrs"/>
    </action-group>
    
    <action-group name="action-group-account-reimbursement-validate-click">
    	<action name="action-method-account-reimbursement-validate"/>
	    <action name="action-reimbursement-hidden-button-attrs"/>
	    <action name="save"/>
    </action-group>
    
    <action-method name="action-method-account-reimbursement-validate">
    	<call class="com.axelor.apps.account.web.ReimbursementController" method="validateReimbursement"/>
    </action-method>
    
 	<action-attrs name="action-reimbursement-hidden-button-attrs">
 		<attribute name="hidden" for="validateReimbursement" expr="eval: status?.code != 'tov' "/>
 	</action-attrs>
	 	
 	<action-attrs name="action-reimbursement-hidden-reject-field-attrs">
 		<attribute name="hidden" for="rejectInformation" expr="eval: rejectedOk == false"/>
 	</action-attrs>

	<search-filters name="reimbursement-filters" model="com.axelor.apps.account.db.Reimbursement" title="Reimbursement filters">
		<filter title="Recent reimbursements">
			<domain></domain>
		</filter>
		<filter title="Rejected reimbursements">
			<domain>self.rejectedOk = true</domain>
		</filter>	
	</search-filters>   
	
</object-views>