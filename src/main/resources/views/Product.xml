<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_0.9.xsd">
    
    
        
    
    <grid name="product-grid" title="Products" model="com.axelor.apps.base.db.Product">
    <toolbar>
		<button name="catelog" title="Catelog" onClick="action-print-product-catelog"/>
    </toolbar>    
        <field name="code"/>
        <field name="name"/>
        <field name="productCategory"/>
        <field name="productFamily"/>
        <field name="unit"/>
        <field name="productTypeSelect"/>
       	<field name="procurementMethodSelect"/>
    </grid>
    
    <form name="product-form" title="Product" model="com.axelor.apps.base.db.Product" cols="2" colWidths="*,400"
		onNew="action-product-record-default-new,action-product-record-sale-supply-select,action-sn-integration-init,action-showing-seen,action-main-cntrl"
		onLoad="action-sn-integration-init,action-showing-seen,action-main-cntrl,com.axelor.sn.web.SNCommonController:refreshSnStatusUpdatesComments">
    
	    <group title="Informations" colSpan="1" cols="6">
	    	<group showTitle="false" colSpan="2">
	    		<field name="picture"/>
	    	</group>
		    <group showTitle="false" colSpan="4" cols="2">
		    	<field name="name"/>
	        	<field name="code"/>
		    </group>
	        <break/>
	        <field name="applicationTypeSelect"/>    
	        <field name="productCategory"/>
	        <field name="productFamily" domain="self.productCategory = :productCategory"/>
	        <field name="productTypeSelect" onChange="action-product-record-sale-supply-select,action-product-validate-sale-supply-select"/>
        	<field name="procurementMethodSelect"/>
        	<field name="saleSupplySelect" onChange="action-product-validate-sale-supply-select"/>
        	<field name="isRawMaterial"/>
	        <field name="invoiceLineType"/>
	        <group showTitle="false" colSpan="6">
		        <field name="startDate"/>
		        <field name="endDate"/>
	        </group>
	    </group>
        <group title="Description" colSpan="1" cols="1">
        	 <field name="description" showTitle="false" colSpan="1"/>
        </group>
        <separator title="Product specific attributes" colSpan="2"/>
        <notebook colSpan="2">
        	<page title="Configuration Prix" cols="4" colSpan="2">
	        	<field name="salePrice"/>
	        	<field name="saleCurrency"/>
	        	<field name="purchasePrice"/>
	        	<field name="purchaseCurrency"/>
	        	<field name="unit"/>
        	</page>
            <page title="Accounting" cols="4" colSpan="2">
                <field name="accountManagementList" grid-view="account-management-product-grid" form-view="account-management-product-form" domain="self.typeSelect = 1" colSpan="4" />
            </page>
<!--             <page title="Related BOMs"> -->
<!--             	<button name="showBillsOfMaterial" title="Show bills of material"/> -->
<!--             	 <portlet action="chart:chart.planned.qty.by.location" height="200" colSpan="2"/> -->
<!--             </page> -->
			<page title="Stock" cols="4" colSpan="2">
				<portlet action="action-product-view-stock" colSpan="4"/>
			</page>
			<page title="Tracking number" cols="4" colSpan="2">
				<field name="hasWarranty" colSpan="4"/>
				<field name="warrantyNbrOfMonths" showIf="hasWarranty"/>
				<break/>
				<field name="isPerishable" colSpan="4"/>
				<field name="perishableNbrOfMonths" showIf="isPerishable"/>
				<break/>
				<field name="trackingNumberConfiguration" colSpan="2"/>
            	<spacer colSpan="2"/>
			</page>
			<page title="Variants">
				<field name="productVariantConfiguration" widget="NestedEditor" summary-view="true" 
						form-view="product-variant-configuration-form" edit-window="self" canSelect="true" showTitle="false"/>
			</page>
			<page title="Social Networking" cols="6" hideIf="id == null">
				<group title="Social Networking Integration" colSpan="3">
					<group colSpan="3" cols="2" name="snIntegrationInit">
						<button name="showing" title="Post Message"
							onClick="action-showing,com.axelor.sn.web.SNCommonController:sayProduct" />
						<button name="retriveCmnt" hideIf="snStatusUpdates == null" title="Comments/Replies"
							onClick="com.axelor.sn.web.SNCommonController:getComments" />
						<spacer colSpan="1" />
					</group>
					<spacer colSpan="1" />
					<break />
					<group colSpan="2" cols="6" name="boolFields" hideIf="snStatusUpdates !=  null">
						<field name="fb" title="Facebook" colSpan="1" widget="[type=boolean]" />
						<field name="ln" title="Linkedin" colSpan="1" widget="[type=boolean]" />
						<field name="twt" title="Twitter" colSpan="1" widget="[type=boolean]" />

					</group>
					<break />
					<group colSpan="3" cols="3" colWidths="20%,*">
						<field name="snStatusUpdates" title="Discussion" readonly="true"
							colSpan="3" canView="true" edit-window="self" form-view="sn-product-comments-form"
							hideIf="snStatusUpdates == null" />
						<break />
						<group colSpan="3" cols="3" colWidths="70%,*">
							<field name="postToSN" showTitle="false" hidden="true"
								colSpan="2" widget="Text" />
							<group colSpan="1" cols="2">
								<button name="postit" title="Post" hidden="true"
									onClick="com.axelor.sn.web.SNCommonController:postOnSN,action-showing-seen, save, com.axelor.sn.web.SNCommonController:refreshSnStatusUpdatesComments" />
								<button name="cancel" title="Cancel" hidden="true"
									onClick="action-showing-seen" />
							</group>
						</group>

					</group>

				</group>
				<group name="snStatusComment" colSpan="3" cols="3">
					<field name="comments" title="Comments" hideIf="snStatusUpdates == null"
						readonly="true"
						widget="SnStatusComments[type=ONE_TO_MANY|target=com.axelor.apps.socialnetwork.db.SnStatusComments]">
						<grid title="Comments">
							<field name="partner" title="By" width="100" />
							<field name="commentText" title="Comment" />
							<field name="commentDateT" title="Time" width="125" />
							<field name="isFacebook" title="Facebook" width="35" />
							<field name="isLinkedin" title="Linkedin" width="35" />
							<field name="isTwitter" title="Twitter" width="35" />
						</grid>
					</field>
				</group>
			</page>
        </notebook>
    </form>
    
    <action-view name="action-product-view-stock" title="Stock" model="com.axelor.apps.supplychain.db.LocationLine">
    	<view type="grid" name="location-line-product-grid"/>
    	<view type="form" name="location-line-product-form"/>
    	<domain>self.product.id = :id</domain>
    	<context name="id" expr="eval: id"/>
    </action-view>
    
    <action-record name="action-product-record-default-new" model="com.axelor.apps.base.db.Product">
    	<field name="applicationTypeSelect" expr="1"/>
    	<field name="productTypeSelect" expr="stockable"/>
    	<field name="procurementMethodSelect" expr="buy"/>
    	<field name="startDate" expr="call:com.axelor.apps.base.service.administration.GeneralService:getTodayDate()" if="startDate == null"/>
    	<field name="salePrice" expr="1"/>
    	<field name="purchasePrice" expr="1"/>
    	<field name="saleCurrency" expr="eval: _activeCompany.currency"/>
    	<field name="purchaseCurrency" expr="eval: _activeCompany.currency"/>
    </action-record>
    
    <action-record name="action-product-record-sale-supply-select" model="com.axelor.apps.base.db.Product">
    	<field name="saleSupplySelect" expr="1" if="productTypeSelect == 'stockable'"/>
    	<field name="saleSupplySelect" expr="3" if="productTypeSelect == 'service'"/>
    </action-record>
    
    <action-validate name="action-product-validate-sale-supply-select">
   		<alert message="A product of type service can't be procured from stock." if="saleSupplySelect == 1 &amp;&amp; productTypeSelect == 'service'"/>
	</action-validate> 

    <!-- ACTIONS FOR SOCIAL NETWORKING INTEGRATION -->

	<action-attrs name="action-sn-integration-init">
		<attribute name="hidden" for="snIntegrationInit" expr="eval:id == null" />
		<attribute name="hidden" for="comments" expr="false"
			if="eval:snStatusUpdates != null" />
	</action-attrs>

	<action-attrs name="action-main-cntrl">
		<attribute name="hidden" for="snStatusUpdates" expr="eval:snStatusUpdates == null" />
	</action-attrs>

	<action-attrs name="action-showing">
		<attribute name="hidden" expr="false" for="postToSN" />
		<attribute name="hidden" expr="false" for="postit" />
		<attribute name="hidden" expr="true" for="showing" />
		<attribute name="hidden" expr="false" for="cancel" />
	</action-attrs>

	<action-attrs name="action-showing-seen">
		<attribute name="hidden" expr="false" for="showing" />		
		<attribute name="hidden" expr="true" for="postToSN" />
		<attribute name="hidden" expr="true" for="postit" />
		<attribute name="hidden" expr="true" for="cancel" />
	</action-attrs>
	
	<action-method name="action-print-product-catelog" >
		<call class="com.axelor.apps.base.web.ProductControllerSimple" method="printProductCatelog"/>
	</action-method>
	<!-- END OF ACTIONS FOR SOCIAL NETWORKING INTEGRATION -->
    
</object-views>
