<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_0.9.xsd">
    
    <grid name="affair-grid" title="Affairs" model="com.axelor.apps.organisation.db.Project">
        <field name="clientPartner"/>
        <field name="contactPartner"/>
        <field name="company"/>
        <field name="affairName"/>
        <field name="isModel"/>
    </grid>
    
    <form cols="6" onNew="action-affair-record-default" name="affair-form" title="Affair" model="com.axelor.apps.organisation.db.Project"
    onSave="action-affair-method-create-default-task-on-save">
	    <group showTitle="false" colSpan="4">
	        <field name="affairName"/>
	        <field name="responsibleUserInfo"/>
	        <field name="defaultTask" hideIf="!isTimeSheetImputable"/>
	        <field name="clientPartner"/>
	        <field name="contactPartner" domain="self.isContact = true"/>
	        <field name="company" widget="SuggestBox"/>
	       	<field name="typeDurationSelect"/>
	        <field name="plannedDuration"/>
	        <field name="description" colSpan="4" widget="Html[lite=true]"/>
	        <group name="specificSettings" title="Specific settings" colSpan="4" canCollapse="true">
	        	<field name="isProject"/>
	        	<field name="isAffair"/>
	            <field name="isModel"/>
	            <field name="modelProject" hideIf="isModel" domain="self.isModel = true"/>
	            <field name="parentProject"/>
	            <field name="imputExpense"/>
	            <field name="typeProjectSelect" showIf="imputExpense == true"/>
	            <field name="isReinvoicingExpense"/>
	            <field name="isReinvoicingTime"/>
	            <field name="isTimeSheetImputable"/> 
	        </group>
	    </group>
	    <group title="Actions" showTitle="false" colSpan="2" cols="1">
	        <button name="createSalesOrder" title="Create quote" colSpan="1"/>
	        <button name="generateNewInstanceOfProject" title="Generate new project instance" hideIf="!isModel" colSpan="1"/>
	        <button name="transformToProject" title="Transform to project" showIf="isProject == true" colSpan="1"/>
	        <button name="createPreSalesTask" title="Create pre-sales task" colSpan="1" onClick="save,action-affair-method-create-pre-sales-task"/>
	    </group>
	    <field name="candidateSet" colSpan="4"/>
	    <field name="employeeSet" colSpan="4"/>
	    <notebook colSpan="6">
	        <page title="Tasks">
	        	<field name="preSalesTask"/>
	            <field name="taskList" grid-view="task-project-grid" form-view="task-form" colSpan="6"/>
	        </page>
	        <page title="Financial information" colSpan="4">
	            <group title="Estimated" colSpan="4" cols="6">
	                <field name="estimatedTurnover"/>
	                <field name="estimatedCost"/>
	                <field name="estimatedMargin"/>
	            </group>
	            <group title="Confirmed" colSpan="4" cols="6">
	                <field name="confirmedTurnover"/>
	                <field name="confirmedCost"/>
	                <field name="confirmedMargin"/>
	            </group>
	            <group title="Reaslized" colSpan="4" cols="6">
	                <field name="realizedTurnover"/>
	                <field name="realizedCost"/>
	                <field name="realizedMargin"/>
	            </group>
	            <group colSpan="6" cols="6">
	                <field name="plannedTime"/>
	                <field name="spentTime"/>
	                <field name="remainingTime"/>
	                <field name="budgetedExpenses"/>
	                <field name="incurredExpenses"/>
	                <field name="remainingExpenses"/>
	            </group>
	        </page>
	        <page title="Membres" colSpan="4">
	            <field name="memberUserInfoSet" colSpan="6"/>
	        </page>
	        <page title="Need">
	            <field name="typeSelect"/>
	            <field name="marketTypeSelect"/>
	            <field name="consultationDate"/>
	            <field name="deadline"/>
	            <field name="complexity"/>
	            <field name="competition"/>
	            <field name="plannedBudget"/>     
	            <field name="answerDate"/>
	            <field name="specificationFile"/>
	            <field name="needDescription"/>
	        </page>
	    </notebook>    
	</form>
	
    <action-record name="action-affair-record-default" model="com.axelor.apps.organisation.db.Project">
		<field name="isTimeSheetImputable" expr="true"/>
		<field name="isAffair" expr="true"/>
	</action-record>
			
	<action-method name="action-affair-method-create-pre-sales-task">
		<call class="com.axelor.apps.organisation.web.ProjectController" method="createPreSalesTask"/>
	</action-method>	
		
	<action-method name="action-affair-method-create-default-task-on-save">
		<call class="com.axelor.apps.organisation.web.ProjectController" method="createDefaultTask"/>
	</action-method>
		
</object-views>