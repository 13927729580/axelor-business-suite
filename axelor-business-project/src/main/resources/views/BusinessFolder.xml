<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_3.0.xsd">

	<grid name="business-folder-grid" title="Business Folders" model="com.axelor.apps.businessproject.db.BusinessFolder">
		<field name="code"/>
		<field name="name"/>
		<field name="customer"/>
		<field name="userResponible" />
		<field name="createdOn" />
		<field name="statusSelect" />
	</grid>

	<form name="business-folder-form" title="Business Folder" model="com.axelor.apps.businessproject.db.BusinessFolder" onSave="action-business-folder-set-seq">
		<panel title="Overview">
		    <field name="name"/>
			<field name="code" readonly="true"/>
			<field name="customer" domain="self.isCustomer = true"/>
			<field name="userResponible" />
			<field name="statusSelect" readonly="true" colSpan="2"/>
			<button name="close" title="Close" colSpan="3" onClick="action-business-project-set-status-close,save" showIf="statusSelect == 1" readonlyIf="id == null"/>
			<button name="open" title="Open" colSpan="3" onClick="action-business-project-set-status-open,save" showIf="statusSelect == 2" readonlyIf="id == null"/>
			<button name="createSalesOrder" title="Create Sales Order" colSpan="4"  readonlyIf="id == null"/>
			<field name="template" domain="self.template = true" canNew="false" colSpan="6"/>
			<button name="createSalesOrderFromTemplate" title="Create Sale Order From Template" colSpan="6" readonlyIf="id == null"/>
		</panel>
		<panel>
			<field name="createdBy" title="User Opened"/>
			<field name="userClosed" readonly="true"/>
			<field name="createdOn" title="Date Opened"/>
			<field name="dateClosed" readonly="true"/>
		</panel>
		<panel-dashlet action="action-view-show-sale-orders-from-folder" title="Sale Orders"/>
	</form>
	
	<action-record name="action-business-folder-set-seq" model="com.axelor.apps.businessproject.db.BusinessFolder">
	    <field name="code" expr="call:com.axelor.apps.base.service.administration.SequenceService:getSequenceNumber('businessFolder')" if="code == null"/>
	</action-record>
	
	<action-record name="action-business-project-set-status-close" model="com.axelor.apps.businessproject.db.BusinessFolder">
	    <field name="statusSelect" expr="eval:2" />
	    <field name="dateClosed" expr="eval:__date__" />
	    <field name="userClosed" expr="eval:__user__" />
	</action-record>
	
	<action-record name="action-business-project-set-status-open" model="com.axelor.apps.businessproject.db.BusinessFolder">
	    <field name="statusSelect" expr="eval:1" />
	</action-record>
	
	<action-view name="action-view-show-sale-orders-from-folder" title="Sale Orders" model="com.axelor.apps.sale.db.SaleOrder">	
		<view type="grid" name="sale-order-grid" />
		<view type="form" name="sale-order-form" />
		<domain>self.businessFolder.id = :folderId</domain>
		<context name="folderId" expr="eval: id" />
	</action-view>
	    
</object-views>
