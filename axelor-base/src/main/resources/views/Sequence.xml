<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_3.0.xsd">
    
  
    <grid name="sequence-grid" title="Sequences" model="com.axelor.apps.base.db.Sequence">
        <field name="name"/>
        <field name="code" />
        <field name="company"/>
        <field name="prefixe"/>
        <field name="suffixe"/>
        <field name="padding"/>
        <field name="toBeAdded"/>
        <field name="nextNum"/>
    </grid>
    
    <form name="sequence-form" title="Sequence" model="com.axelor.apps.base.db.Sequence" onNew="action-group-base-sequence-onnew" onLoad="action-sequence-attrs">
		<panel itemSpan="12">
			<field name="code" onChange="action-sequence-attrs"/>
			<field name="company" widget="SuggestBox"/>
			<field name="name"/>
		</panel>
		<panel title="Tips" sidebar="true" itemSpan="6">
			<label title="The tags below can be used as a prefix or a suffix :" />
			<label title="%Y  : Year" />
			<label title="%M  : Month" />
			<label title="%D  : Day" />
			<label title="%WY : Week number" />
		</panel>
		<panel title="Sequence Definition" colSpan="12">
			<field name="prefixe"/>
			<field name="suffixe"/>
			<field name="padding"/>
			<field name="toBeAdded"/>
			<field name="nextNum"/>
			<spacer/>
			<field name="yearlyResetOk" readonlyIf="monthlyResetOk"/>
			<field name="monthlyResetOk" onChange="action-sequence-monthly-reset"/>
			<field name="resetDate" showIf="yearlyResetOk || monthlyResetOk" requiredIf="yearlyResetOk || monthlyResetOk" />
		</panel>
	</form>
    
    <!-- ACTION GROUPs -->
    <action-group name="action-group-base-sequence-onnew">
    	<action name="action-sequence-default"/>
    	<action name="action-sequence-attrs"/>
    </action-group>
    
    <!-- ACTION RECORD -->
    <action-record name="action-sequence-default" model="com.axelor.apps.base.db.Sequence">
    	<field name="padding" expr="3"/>
    	<field name="nextNum" expr="1"/>
    	<field name="toBeAdded" expr="1"/>
		<field name="resetDate" expr="eval: com.axelor.apps.base.service.administration.GeneralService.getTodayDate()"/>
    	<field name="company"  expr="eval:__user__.activeCompany" if="__user__.activeCompany != null"/>
    	<field name="company"  expr="eval:__repo__.of(Company).all().fetchOne()" if="__user__.activeCompany == null &amp;&amp; __repo__.of(Company).all().fetch().size == 1"/>
    </action-record>
    
    <action-attrs name="action-sequence-attrs">
    	<attribute name="hidden" for="company" expr="eval: code in ['contract','contractLine','invoicePaymentCondition','partner']"/>
    	<attribute name="required" for="company" expr="eval: !(code in ['contract','contractLine','invoicePaymentCondition','partner'])"/>
    </action-attrs>
    
    <action-record name="action-sequence-monthly-reset" model="com.axelor.apps.base.db.Sequence">
    	<field name="yearlyResetOk" expr="eval: true" if="monthlyResetOk"/>
    </action-record>
    
</object-views>